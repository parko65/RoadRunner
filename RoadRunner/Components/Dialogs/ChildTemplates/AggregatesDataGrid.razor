@using AutoMapper
@using RoadRunner.Models
@using Service.Contracts

<FluentDataGrid Items="_aggregates">
    <PropertyColumn Property="@(a => a.MaterialNumber)" Title="Number" />
    <PropertyColumn Property="@(a => a.Name)" Title="Name" />
</FluentDataGrid>


@code {
    [Inject]
    public IServiceManager Service { get; set; } = default!;

    [Inject]
    public IMapper Mapper { get; set; } = default!;

    private IQueryable<AggregateModel>? _aggregates;

    protected override async Task OnInitializedAsync()
    {
        var aggregates = await Service.AggregateService.GetAggregatesAsync(trackChanges: false);

        if (aggregates is not null)
        {
            var aggs = Mapper.Map<List<AggregateModel>>(aggregates);

            _aggregates = aggs.AsQueryable();
        }
    }
}
